import{_ as a,c as t,a as i,o as p}from"./app-Tf8BuBYq.js";const s="/assets/bf3ded188ec573ab7c58302cc981fef3-cDi9W_04.png",r="/assets/112fb6bd429adde75ba79137f82b3424-DH5Iyxt1.png",o="/assets/7d5d61eab5566e4598292421064daec2-BzDZ8dxE.png",c="/assets/e79966a97b9a125c0871488962f05a01-98M8NmEY.png",n="/assets/51f881893e3a011acf3916260a6841ae-CquIAt50.png",l="/assets/8d65236684dc70819b86b0f25ff412ed-C1M1yc9H.png",d="/assets/7f2cbab212c12036a9bd28c2e64aef2c-GfDaUNt1.png",g="/assets/0d3366a505248945cf2a7c136fee94d7-uxgXJGN3.png",f="/assets/b3cbdc80b8dcfa3b26185f83e1050a46-DLOM1JkR.png",h="/assets/a62c0ecc6e664be1f8522dc03733a6b1-BrHY7wQA.png",m="/assets/4aa1f4d13df41fe03f6d48da77b00335-BpJsonzl.png",b="/assets/0fa8680957d26c548d6fc3013985682e-BUalXcPA.png",u="/assets/20aa88e1154cf2289a191d4c07442624-B3QOJ8Mg.png",y={};function _(x,e){return p(),t("div",null,[...e[0]||(e[0]=[i('<div class="hint-container caution"><p class="hint-container-title">警告</p><p>目前本文介绍方法已无法使用。保留此文章用于感谢原作者过去的贡献。</p></div><hr><p>本文为转载文章，已获得原作者授权。</p><ul><li>原文：E5 自动订阅程序[已开源] - 浅忆博客</li><li>链接：<a href="https://qyi.io/archives/687.html" target="_blank" rel="noopener noreferrer">https://qyi.io/archives/687.html</a></li></ul><figure><img src="'+s+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>如果你还没有申请到E5账号，请访问这篇文章：<a href="https://blog.csdn.net/weixin_44495599/article/details/121130579" target="_blank" rel="noopener noreferrer">Microsoft 365 E5开发者账号25T存储空间免费领取教程_异想之旅的博客-CSDN博客</a></p><p>以下为调整排版后的原文内容。</p><hr><blockquote><p>由于我前端是废的，界面将就看看就行了，不影响程序~ 申请office E5 开发者试用的教程： <a href="https://blog.curlc.com/archives/599.html" target="_blank" rel="noopener noreferrer">新版可续签的Office 365开发者试用订阅！E5(附自动续订的方法)</a><a href="https://blog.curlc.com/archives/66.html" target="_blank" rel="noopener noreferrer">Onedrive容量 1T 修改 为5T，老帐号不删除重建</a></p></blockquote><h1 id="说明" tabindex="-1"><a class="header-anchor" href="#说明"><span>说明</span></a></h1><ol><li>此程序部署在我的服务器上，每隔2小时会自动调用outlook api 获取邮件列表</li><li>对于信息: 只会保存必要的 client_id、client_secret，其他任何内容都不会保存，</li><li>会读取授权的outlook账号邮箱邮件，但不会保存任何信息，仅仅是调用api。</li><li>请单独创建一个同域 E5 子账号进行授权，不要使用此账号进行发送、接收个人邮件，以免发生误会。</li></ol><p>新手作代码辣鸡，估计会出现各种问题，所以还是不建议自己搭建。</p><p>项目地址：<a href="https://github.com/luoye663/e5" target="_blank" rel="noopener noreferrer">https://github.com/luoye663/e5</a></p><h1 id="使用教程" tabindex="-1"><a class="header-anchor" href="#使用教程"><span>使用教程</span></a></h1><h3 id="一、注册自己的api-key" tabindex="-1"><a class="header-anchor" href="#一、注册自己的api-key"><span>一、注册自己的api key</span></a></h3><p>登录进入 azure ，登录账号使用你的e5账户 ，就是以xxx.onmicrosoft.com开头的的账户。</p><p>点击直达链接：<a href="https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/RegisteredApps" target="_blank" rel="noopener noreferrer">https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/RegisteredApps</a></p><p>点击 新注册</p><figure><img src="'+r+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>名称随意取一个，但是最重要的是 “重定向 URI (可选)”，请填写为下列地址，不然程序收不到回调。</p><div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-text"><span class="line"><span>https://e5.qyi.io/outlook/auth2/receive</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><blockquote><p>2020-03-02 15:32 小伙伴们注意了，这里受支持的账户类型 重定向 URI (可选)一定要填对，不然无法授权的哦。</p></blockquote><p>（由于微软更新，页面可能略有不同，故重新截图，与原文有异处——转载注）</p><figure><img src="'+o+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>点击注册后记录以下信息:</p><ol><li>应用程序(客户端)ID</li><li>客户端密码</li></ol><p>应用程序(客户端)ID：</p><figure><img src="'+c+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>创建客户端密码：</p><figure><img src="'+n+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>客户端密码请复制 “值”，不要复制 ID。</p><figure><img src="'+l+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><blockquote><p>2021-08-19： 有些教程让你选永久，然而客户端密码这里过期时间已经没有了“从不”，只能选2年。(别在意这些，谁也不知道2年后微软的策略会不会变，2年换一次密钥也不麻烦)</p></blockquote><p>保存好以上2个key，一会需要用到。</p><h3 id="二、配置api权限" tabindex="-1"><a class="header-anchor" href="#二、配置api权限"><span>二、配置api权限</span></a></h3><p>看图操作 <img src="'+d+'" alt="" loading="lazy"><img src="'+g+'" alt="" loading="lazy"></p><p>勾选一下四个选项后，同时点击 代表XX授予管理员同意</p><p><strong>！！！这一步用的是子账号创建的api（也推荐使用子账号），那么这一项是灰色的，不能点击。需要点击右上角切换账号并登录 管理员 账号，再点击 代表XX授予管理员同意</strong></p><figure><img src="'+f+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>这个时候api的配置就算完成了</p><h3 id="三、添加key到自动订阅程序" tabindex="-1"><a class="header-anchor" href="#三、添加key到自动订阅程序"><span>三、添加key到自动订阅程序</span></a></h3><p>进入 <a href="https://e5.qyi.io/" target="_blank" rel="noopener noreferrer">https://e5.qyi.io/</a> 这里需要github账户登录，同样的，我只能获取你在 github中的 用户id、用户名等基础信息(邮箱获取不了)，其他的任何信息也获取不到(可自行尝试注册一个github Apps测试)。</p><p>点击图标 登录后进入主页面</p><p>点击 新建：</p><ul><li>名称随意输入，只是个标识而已</li><li>描述可空</li></ul><p>创建好后点击 配置</p><figure><img src="'+h+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>填入上一步记录的 应用程序(客户端)ID、客户端密码</p><ul><li>client_id -&gt;应用程序(客户端)ID</li><li>client_secret-&gt;客户端密码</li></ul><figure><img src="'+m+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>点击下一步进行配置调用时间，说明：单位 秒（最低调用频率为 60 秒,最高为6小时），例如: 30-60,代表在30秒-60秒之间随机调用一次</p><figure><img src="'+b+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>再点击下一步，到了 授权 ，</p><figure><img src="'+u+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>此时会跳转到 microsoftonline Auth2.0授权页面，在这里请注意使用同一个域下的空账号(子账号)进行授权。</p><p>(因为在这一步我能获取到授权的outlook账户 邮件，但是程序不会保存，仅仅是调用api。)以免在以后发生误会。</p><p>点击 接受 后，将会跳转回自动订阅程序。</p><p>到此时，授权就完成了。</p><h3 id="完事了-已经没啦" tabindex="-1"><a class="header-anchor" href="#完事了-已经没啦"><span>完事了，已经没啦~</span></a></h3><p>到这里你就可以不用管了，程序会每一段时间调用一次outlook的api。</p><p>界面写得辣鸡，因为我不会前端呀~大家将就看看就行了。</p><p>过几天我会把删除功能加上，可以删除在程序里注册的账户。</p><p>交流群：959720211</p><p>还是要说一下隐私安全问题，因为有几个读者也说到了，统一回答下</p><p>api权限仅拥有 openid offline_access Mail.Read Mail.ReadWrite Mail.ReadBasic Mail.ReadBasic.ALL 这6个权限</p><p>也就是说我仅仅能读取授权账户的邮件，其他任何事都做不了，且我写的这个程序没有保存任何除key之外的信息</p><p>所以一开始我就说了，用子账户进行授权（空账户）及创建api，这样不涉及到 隐私及安全问题。</p><p>如果实在担心不想用了，azure 直接删掉api就可以了。</p>',68)])])}const v=a(y,[["render",_]]),z=JSON.parse('{"path":"/article/wsmgcs38/","title":"【转载】Microsoft 365 E5邮件API调用自动订阅无限续订服务","lang":"zh-CN","frontmatter":{"title":"【转载】Microsoft 365 E5邮件API调用自动订阅无限续订服务","createTime":"2022/01/22 17:32:57","tags":["转载"],"copyright":{"creation":"reprint","source":"https://qyi.io/archives/687.html","author":"浅忆博客","license":{"name":"未知","url":null}},"badge":{"type":"danger","text":"已过时"},"permalink":"/article/wsmgcs38/","description":"警告 目前本文介绍方法已无法使用。保留此文章用于感谢原作者过去的贡献。 本文为转载文章，已获得原作者授权。 原文：E5 自动订阅程序[已开源] - 浅忆博客 链接：https://qyi.io/archives/687.html 如果你还没有申请到E5账号，请访问这篇文章：Microsoft 365 E5开发者账号25T存储空间免费领取教程_异想之旅的...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"【转载】Microsoft 365 E5邮件API调用自动订阅无限续订服务\\",\\"image\\":[\\"https://yxzl.dev/images/bf3ded188ec573ab7c58302cc981fef3.png\\",\\"https://yxzl.dev/images/112fb6bd429adde75ba79137f82b3424.png\\",\\"https://yxzl.dev/images/7d5d61eab5566e4598292421064daec2.png\\",\\"https://yxzl.dev/images/e79966a97b9a125c0871488962f05a01.png\\",\\"https://yxzl.dev/images/51f881893e3a011acf3916260a6841ae.png\\",\\"https://yxzl.dev/images/8d65236684dc70819b86b0f25ff412ed.png\\",\\"https://yxzl.dev/images/7f2cbab212c12036a9bd28c2e64aef2c.png\\",\\"https://yxzl.dev/images/0d3366a505248945cf2a7c136fee94d7.png\\",\\"https://yxzl.dev/images/b3cbdc80b8dcfa3b26185f83e1050a46.png\\",\\"https://yxzl.dev/images/a62c0ecc6e664be1f8522dc03733a6b1.png\\",\\"https://yxzl.dev/images/4aa1f4d13df41fe03f6d48da77b00335.png\\",\\"https://yxzl.dev/images/0fa8680957d26c548d6fc3013985682e.png\\",\\"https://yxzl.dev/images/20aa88e1154cf2289a191d4c07442624.png\\"],\\"dateModified\\":\\"2025-10-10T04:50:50.000Z\\",\\"author\\":[]}"],["meta",{"property":"og:url","content":"https://yxzl.dev/article/wsmgcs38/"}],["meta",{"property":"og:site_name","content":"异想之旅のBlog"}],["meta",{"property":"og:title","content":"【转载】Microsoft 365 E5邮件API调用自动订阅无限续订服务"}],["meta",{"property":"og:description","content":"警告 目前本文介绍方法已无法使用。保留此文章用于感谢原作者过去的贡献。 本文为转载文章，已获得原作者授权。 原文：E5 自动订阅程序[已开源] - 浅忆博客 链接：https://qyi.io/archives/687.html 如果你还没有申请到E5账号，请访问这篇文章：Microsoft 365 E5开发者账号25T存储空间免费领取教程_异想之旅的..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://yxzl.dev/images/bf3ded188ec573ab7c58302cc981fef3.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-10-10T04:50:50.000Z"}],["meta",{"property":"article:tag","content":"转载"}],["meta",{"property":"article:modified_time","content":"2025-10-10T04:50:50.000Z"}]]},"git":{"createdTime":1758874804000,"updatedTime":1760071850000},"autoDesc":true,"filePathRelative":"tech/20220122173257.md","headers":[]}');export{v as comp,z as data};
